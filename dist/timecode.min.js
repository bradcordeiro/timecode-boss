'use strict';var _slicedToArray=function(){function a(b,d){var e=[],g=!0,j=!1,k=void 0;try{for(var n,l=b[Symbol.iterator]();!(g=(n=l.next()).done)&&(e.push(n.value),!(d&&e.length===d));g=!0);}catch(o){j=!0,k=o}finally{try{!g&&l['return']&&l['return']()}finally{if(j)throw k}}return e}return function(b,d){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,d);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(b,d){for(var g,e=0;e<d.length;e++)g=d[e],g.enumerable=g.enumerable||!1,g.configurable=!0,'value'in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}return function(b,d,e){return d&&a(b.prototype,d),e&&a(b,e),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var TimecodeRegex=/(\d{1,2})\D(\d{1,2})\D(\d{1,2})\D(\d{1,2})/,Timecode=function(){function a(b,d){return _classCallCheck(this,a),this.frameRate=d||29.97,this.frameCount=0,b&&this.set(b),this}return _createClass(a,[{key:'set',value:function set(b){if(b instanceof a)this.frameCount=b.frameCount,this.frameRate=b.frameRate;else if(b instanceof Date)this.setFrameCountFromDate(b);else if(TimecodeRegex.test(b))this.setFrameCountFromString(b);else if('number'==typeof b)this.frameCount=Math.floor(b);else if('object'===('undefined'==typeof b?'undefined':_typeof(b)))this.setFrameCountFromObject(b);else throw new TypeError('Invalid timecode parameter "'+b+'"');return this}},{key:'setFrameCountFromString',value:function setFrameCountFromString(b){var _TimecodeRegex$exec=TimecodeRegex.exec(b),_TimecodeRegex$exec2=_slicedToArray(_TimecodeRegex$exec,5),d=_TimecodeRegex$exec2[1],e=_TimecodeRegex$exec2[2],g=_TimecodeRegex$exec2[3],j=_TimecodeRegex$exec2[4];return this.setHours(d),this.setMinutes(e),this.setSeconds(g),this.isDropFrame()&&2>j&&'00'===g&&0!=e%10?this.setFrames(parseInt(j,10)+2):this.setFrames(j),this}},{key:'setFrameCountFromObject',value:function setFrameCountFromObject(b){return Object.prototype.hasOwnProperty.call(b,'hours')&&this.setHours(b.hours),Object.prototype.hasOwnProperty.call(b,'minutes')&&this.setMinutes(b.minutes),Object.prototype.hasOwnProperty.call(b,'seconds')&&this.setSeconds(b.seconds),Object.prototype.hasOwnProperty.call(b,'frames')&&this.setFrames(b.frames),this}},{key:'setFrameCountFromDate',value:function setFrameCountFromDate(b){return this.setHours(b.getHours()),this.setMinutes(b.getMinutes()),this.setSeconds(b.getSeconds()),this.setFrames(Math.floor(b.getMilliseconds()/this.nominalFrameRate())),this}},{key:'toString',value:function toString(){var b=this.separator(),d=this.getHours().toString(10).padStart(2,'0'),e=this.getMinutes().toString(10).padStart(2,'0'),g=this.getSeconds().toString(10).padStart(2,'0'),j=this.getFrames().toString(10).padStart(2,'0');return''+(d+'')+(b+'')+(e+'')+(b+'')+(g+'')+(b+'')+(j+'')}},{key:'toObject',value:function toObject(){return Object.assign({},this)}},{key:'getFields',value:function getFields(b){return!0===b?{hours:this.getHours().toString(10).padStart(2,'0'),minutes:this.getMinutes().toString(10).padStart(2,'0'),seconds:this.getSeconds().toString(10).padStart(2,'0'),frames:this.getFrames().toString(10).padStart(2,'0')}:{hours:this.getHours(),minutes:this.getMinutes(),seconds:this.getSeconds(),frames:this.getFrames()}}},{key:'getHours',value:function getHours(){var b=24*this.framesPerHour();return this.frameCount>=b&&(this.frameCount%=b),0>this.frameCount&&(this.frameCount+=b),Math.floor(this.frameCount/this.framesPerHour())}},{key:'setHours',value:function setHours(b){var d=parseInt(b,10)%24;if(Number.isNaN(d))throw new TypeError('Cannot set hours to '+(b+''));return this.frameCount-=this.framesInHoursField(),this.frameCount+=d*this.framesPerHour(),this}},{key:'getMinutes',value:function getMinutes(){var b=this.framesInHoursField(),d=this.framesPer10Minute(),e=this.framesPerMinute(),g=this.frameCount-b,j=Math.floor(g/d);g-=j*d;var k=Math.min(Math.floor(g/e),9);return 10*j+k}},{key:'setMinutes',value:function setMinutes(b){var d=parseInt(b,10);if(Number.isNaN(d))throw new TypeError('Cannot set minutes to '+(b+''));return this.frameCount-=this.framesInMinutesField(),this.frameCount+=Math.floor(d/10)*this.framesPer10Minute(),this.frameCount+=d%10*this.framesPerMinute(),this}},{key:'getSeconds',value:function getSeconds(){var b=this.frameCount-this.framesInHoursField()-this.framesInMinutesField();return Math.floor(b/this.nominalFrameRate())}},{key:'setSeconds',value:function setSeconds(b){var d=parseInt(b,10);if(Number.isNaN(d))throw new TypeError('Cannot set minutes to '+(b+''));return this.frameCount-=this.framesInSecondsField(),this.frameCount+=d*this.nominalFrameRate(),this}},{key:'getFrames',value:function getFrames(){var b=this.frameCount-this.framesInHoursField();return b-=this.framesToDrop(),b-=this.framesInMinutesField(),b+=this.framesToDrop(),b-=this.framesInSecondsField(),b%this.nominalFrameRate()}},{key:'setFrames',value:function setFrames(b){var d=parseInt(b,10);if(Number.isNaN(d))throw new TypeError('Cannot set minutes to '+(b+''));return this.frameCount-=this.getFrames(),this.frameCount+=d,this}},{key:'convert',value:function convert(b){return new a(this.frameCount,b)}},{key:'nominalFrameRate',value:function nominalFrameRate(){var b=30<this.frameRate?this.frameRate/2:this.frameRate;return Math.round(b)}},{key:'framesPerHour',value:function framesPerHour(){return 6*this.framesPer10Minute()}},{key:'framesPer10Minute',value:function framesPer10Minute(){return 10*this.framesPerMinute()+this.framesToDrop()}},{key:'framesPerMinute',value:function framesPerMinute(){return 60*this.nominalFrameRate()-this.framesToDrop()}},{key:'framesToDrop',value:function framesToDrop(){return this.isDropFrame()?this.nominalFrameRate()/15:0}},{key:'isDropFrame',value:function isDropFrame(){return 29<this.frameRate&&30>this.frameRate||59<this.frameRate&&60>this.frameRate}},{key:'separator',value:function separator(){return this.isDropFrame()?';':':'}},{key:'framesInHoursField',value:function framesInHoursField(){return this.getHours()*this.framesPerHour()}},{key:'framesInMinutesField',value:function framesInMinutesField(){return Math.floor(this.getMinutes()/10)*this.framesPer10Minute()+this.getMinutes()%10*this.framesPerMinute()}},{key:'framesInSecondsField',value:function framesInSecondsField(){return this.getSeconds()*this.nominalFrameRate()}},{key:'add',value:function add(b){var d=new a(this);return d.frameCount+=b instanceof a?b.frameCount:new a(b,this.frameRate).frameCount,d}},{key:'subtract',value:function subtract(b){var d=new a(this);return d.frameCount-=b instanceof a?b.frameCount:new a(b,this.frameRate).frameCount,d}}]),a}();module.exports=Timecode;